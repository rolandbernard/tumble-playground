{"version":3,"sources":["logo.svg","tumble-compiler.js","ui/button.js","ui/code-editor.js","ui/paper.js","ui/header.js","ui/spinner.js","app.js","index.js"],"names":["module","exports","compiler","onPrint","a","Promise","res","window","addEventListener","Tumble","text","ready","Button","props","color","variant","isLink","children","disabled","others","ripple_root","createRef","onMouseDown","event","button","target","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","ripple","document","createElement","classList","add","ripple_child","appendChild","size","Math","sqrt","clientWidth","clientHeight","style","width","height","getElementsByClassName","onMouseUpOrLeave","root_ripple","childNodes","forEach","contains","removeChild","classes","toLowerCase","className","onMouseUp","onMouseLeave","ref","CodeEditor","value","onChange","input","line_count","split","length","Array","keys","map","i","key","onKeyDown","sel_start_pos","currentTarget","selectionStart","sel_end_pos","selectionEnd","new_value","substring","preventDefault","current","placeholder","autoComplete","autoCorrect","autoCapitalize","spellCheck","scrolling","Paper","Header","Spacer","Spinner","globalOutput","App","useState","setInput","output","setOutput","loading","setLoading","running","setRunning","useEffect","initCompiler","then","flex","src","Logo","alt","display","flexDirection","margin","onClick","program","FS","writeFile","callMain","replace","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.f6a188f8.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.4f27ef60.svg\";","\nlet compiler = null;\n\n/* global Tumble */\n\nexport async function initCompiler(onPrint) {\n    await new Promise((res) => {\n        window.addEventListener('load', () => res());\n        if (typeof(Tumble) !== 'undefined') {\n            res();\n        }\n    });\n    compiler = await Tumble({\n        'print': function (text) { onPrint(text) },\n        'printErr': function (text) { onPrint(text) },\n    });\n    await compiler.ready;\n}\n\nexport function runProgram(program) {\n    compiler.FS.writeFile('program.tumble', program);\n    compiler.callMain(['program.tumble', '-e', 'jit', '-t', 'wasm32', \"--force-target\"]);\n}\n","\nimport React, { createRef } from 'react';\n\nimport './button.scss';\n\nexport function Button(props) {\n    const { color, variant, isLink, children, disabled, ...others } = props;\n    const ripple_root = createRef();\n    const onMouseDown = (event) => {\n        let button = event.target;\n        let rect = button.getBoundingClientRect();\n        let x = event.clientX - rect.left;\n        let y = event.clientY - rect.top;\n        let ripple = document.createElement('span');\n        ripple.classList.add('ui-touch-ripple-ripple');\n        let ripple_child = document.createElement('span');\n        ripple_child.classList.add('ui-touch-ripple-child');\n        ripple.appendChild(ripple_child);\n        let size = Math.sqrt(button.clientWidth * button.clientWidth + button.clientHeight * button.clientHeight);\n        ripple.style.width = (size * 2) + 'px';\n        ripple.style.height = (size * 2) + 'px';\n        ripple.style.left = (x - size) + 'px';\n        ripple.style.top = (y - size) + 'px';\n        let root_ripple = button.getElementsByClassName('ui-touch-ripple-root')[0];\n        root_ripple.appendChild(ripple);\n    };\n    const onMouseUpOrLeave = (event) => {\n        let button = event.target;\n        let root_ripple = button.getElementsByClassName('ui-touch-ripple-root')[0];\n        root_ripple.childNodes.forEach((ripple) => {\n            let ripple_child = ripple.childNodes[0];\n            if (!ripple_child.classList.contains('ui-touch-ripple-child-exit')) {\n                ripple_child.classList.add('ui-touch-ripple-child-exit');\n                ripple_child.addEventListener('animationend', () => {\n                    root_ripple.removeChild(ripple);\n                });\n            }\n        });\n    };\n    let classes = 'ui-button';\n    if(variant && variant.toLowerCase() === 'outlined') {\n        classes += ' ui-button-outlined';\n    } else if(variant && variant.toLowerCase() === 'text') {\n        classes += ' ui-button-text';\n    }\n    if(color && color.toLowerCase() === 'primary') {\n        classes += ' ui-button-primary';\n    } else if(color && color.toLowerCase() === 'secondary') {\n        classes += ' ui-button-secondary';\n    }\n    if(disabled) {\n        classes += ' ui-button-disabled';\n    }\n    return (isLink ?\n        (<a\n            className={classes}\n            onMouseDown={onMouseDown}\n            onMouseUp={onMouseUpOrLeave}\n            onMouseLeave={onMouseUpOrLeave}\n            { ...others }\n        >\n            <span ref={ripple_root} className=\"ui-touch-ripple-root\"></span>\n            <span className=\"ui-button-content\" children={children}></span>\n        </a>) :\n        (<button\n            className={classes}\n            onMouseDown={onMouseDown}\n            onMouseUp={onMouseUpOrLeave}\n            onMouseLeave={onMouseUpOrLeave}\n            disabled={disabled}\n            { ...others }\n        >\n            <span ref={ripple_root} className=\"ui-touch-ripple-root\"></span>\n            <span className=\"ui-button-content\" children={children}></span>\n        </button>)\n    );   \n}\n\nexport default Button;\n","\nimport React, { createRef } from 'react';\n\nimport './code-editor.scss';\n\nexport function CodeEditor(props) {\n    const { value, onChange, ...others } = props;\n    const input = createRef();\n    let line_count = value ? value.split('\\n').length : 1;\n    const myOnChange = (event) => {\n        if (onChange) {\n            onChange(event.target.value);\n        }\n    };\n    const onKeyPress = (event) => {\n        if (event.key === \"Tab\") {\n            let sel_start_pos = event.currentTarget.selectionStart;\n            let sel_end_pos = event.currentTarget.selectionEnd;\n            let new_value = value.substring(0, sel_start_pos) + \"    \" + value.substring(sel_end_pos);\n            event.preventDefault();\n            input.current.value = new_value;\n            input.current.selectionStart = sel_start_pos + 4;\n            input.current.selectionEnd = sel_start_pos + 4;\n            onChange(new_value);\n        }\n    }\n    return (\n        <div className=\"ui-code-editor\" {...others}>\n            <div className=\"ui-code-editor-container\">\n                <div className=\"ui-code-editor-lines\">\n                    {[...Array(line_count).keys()].map((i) => (\n                        <span key={i} className=\"ui-code-editor-linenumber\">{i + 1}</span>\n                    ))}\n                </div>\n                <textarea\n                    ref={input}\n                    value={value}\n                    onChange={myOnChange}\n                    onKeyDown={onKeyPress}\n                    className=\"ui-code-editor-input\"\n                    placeholder=\"Type some code...\"\n                    autoComplete=\"off\" autoCorrect=\"off\" autoCapitalize=\"off\" spellCheck=\"false\"\n                    scrolling=\"no\"\n                ></textarea>\n            </div>\n        </div>\n    );\n}\n\nexport default CodeEditor;\n","\nimport React from 'react';\n\nimport './paper.scss';\n\nexport function Paper(props) {\n    return (\n        <span className=\"ui-paper\" {...props}>\n        </span>\n    );\n}\n\nexport default Paper;\n\n","\nimport React from 'react';\n\nimport './header.scss';\n\nexport function Header(props) {\n    return (\n        <div className=\"ui-header\" {...props}>\n        </div>\n    );\n}\n\nexport function Spacer(props) {\n    return (<span className=\"ui-header-spacer\" {...props}></span>)\n}\n\nexport default Header;","\nimport React from 'react';\n\nimport './spinner.scss';\n\nexport function Spinner(props) {\n    return (\n        <span className=\"ui-spinner\">\n            {[...Array(10).keys()].map((i) => (\n                <span key={i}></span>\n            ))}\n        </span>\n    );\n}\n\nexport default Spinner;\n","\nimport React from 'react';\nimport { useState, useEffect } from 'react';\n\nimport { initCompiler, runProgram } from './tumble-compiler';\nimport Button from './ui/button';\nimport CodeEditor from './ui/code-editor';\nimport Paper from './ui/paper';\nimport { Header, Spacer } from './ui/header';\nimport Spinner from './ui/spinner';\nimport Logo from './logo.svg';\nimport './app.scss';\n\nlet globalOutput = \"\";\n\nconst initial_code = '\\nextern printf(fmt: *i8, ..);\\n\\nmain() {\\n    printf(\"Hello world!\\\\n\");\\n}\\n';\n\nfunction App() {\n    const [input, setInput] = useState(initial_code);\n    const [output, setOutput] = useState(\"\");\n    const [loading, setLoading] = useState(true);\n    const [running, setRunning] = useState(false);\n    globalOutput = output;\n    useEffect(() => {\n        initCompiler((text) => {\n            globalOutput += (globalOutput ? '\\n' : '') + text;\n        }).then(() => {\n            setLoading(false);\n        })\n    }, []);\n    const onRunProgram = () => {\n        setRunning(true);\n        runProgram(input);\n        setOutput(globalOutput);\n        setRunning(false);\n    }\n    const onClearOutput = () => {\n        setOutput('');\n    }\n    return (\n        <div className=\"app-root\">\n            <Header style={{ flex: '0 0 auto' }}>\n                <Spacer></Spacer>\n                <img src={Logo} alt=\"Logo\" className=\"header-logo\"></img>\n                <span className=\"header-title\">Tumbleweed</span>\n                <Spacer></Spacer>\n            </Header>\n            {loading ?\n                (<div className=\"app-content-loading\"><Spinner></Spinner></div>) :\n                (<div className=\"app-content\">\n                    <div style={{ flex: '1 1 100%', display: 'flex', flexDirection: 'column' }}>\n                        <div className=\"app-content-header\">\n                            Input:\n                        <Spacer></Spacer>\n                            <Button\n                                disabled={running}\n                                color=\"primary\"\n                                style={{ margin: 0, flex: '0 0 auto' }}\n                                onClick={onRunProgram}\n                            >Run program</Button>\n                        </div>\n                        <CodeEditor\n                            style={{ flex: '1 1 100%' }}\n                            value={input}\n                            onChange={(value) => setInput(value)}\n                        ></CodeEditor>\n                    </div>\n                    <div style={{ flex: '1 1 75%', display: 'flex', flexDirection: 'column' }}>\n                        <div className=\"app-content-header\">\n                            Output:\n                        <Spacer></Spacer>\n                            <Button\n                                variant=\"outlined\"\n                                color=\"secondary\"\n                                style={{ margin: 0, flex: '0 0 auto' }}\n                                onClick={onClearOutput}\n                            >Clear output</Button>\n                        </div>\n                        <Paper style={{ flex: '1 1 100%' }}><pre>{output.replace(/\\x1B\\[.*?m/g, \"\")}</pre></Paper>\n                    </div>\n                </div>)\n            }\n            \n        </div>\n    );\n}\n\nexport default App;\n","\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'typeface-roboto';\n\nimport App from './app';\nimport './index.scss';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}